name: Daily Shopify Auto Update (MON)

on:
  schedule:
    - cron: "0 0 * * *"   # ë§¤ì¼ 0ì‹œ(í•œêµ­ì‹œê°„ ì˜¤ì „ 9ì‹œ)ì— ì‹¤í–‰
  workflow_dispatch:       # ìˆ˜ë™ ì‹¤í–‰ë„ ê°€ëŠ¥

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install dependencies
        run: sudo apt-get update && sudo apt-get install -y jq zip

      - name: Daily message update
        run: |
          echo "ğŸ•“ ë§¤ì¼ ìë™ ì—…ë°ì´íŠ¸ ì‹œì‘..."
          echo "Auto update on $(date '+%Y-%m-%d %H:%M:%S')" > daily_update_log.txt
          echo "âœ… ì˜¤ëŠ˜ì˜ ìë™ ì—…ë°ì´íŠ¸ ì™„ë£Œ!" >> daily_update_log.txt

      - name: Deploy theme with Shopify CLI
        env:
          SHOPIFY_STORE: ${{ secrets.SHOPIFY_STORE }}
          SHOPIFY_ADMIN_API_TOKEN: ${{ secrets.SHOPIFY_ADMIN_API_TOKEN }}
        run: |
          echo "ğŸš€ Shopify í…Œë§ˆ ìë™ ë°°í¬ ì¤‘..."
          curl -s -X POST "https://${{ secrets.SHOPIFY_STORE }}/admin/api/2024-10/themes.json" \
          -H "X-Shopify-Access-Token: ${{ secrets.SHOPIFY_ADMIN_API_TOKEN }}" \
          -H "Content-Type: application/json" \
          -d '{"theme":{"name":"Auto Daily Update","role":"unpublished"}}'
          echo "ğŸ‰ ë°°í¬ ì™„ë£Œ!"
